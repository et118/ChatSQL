<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="styles/index.css">
        <script>
            function show_login_popup(status_message = "") {
                document.getElementById('login_form').style.visibility='visible';
                document.getElementById('login_form').style.pointerEvents='auto';
                document.getElementById('overlay_blur').style.visibility='visible';
                document.getElementById('overlay_blur').style.pointerEvents='auto';
                document.getElementById('login_status').innerText = status_message;
            }

            function show_signup_popup(status_message = "") {
                document.getElementById('signup_form').style.visibility='visible';
                document.getElementById('signup_form').style.pointerEvents='auto';
                document.getElementById('overlay_blur').style.visibility='visible';
                document.getElementById('overlay_blur').style.pointerEvents='auto';
                document.getElementById('signup_status').innerText = status_message;
            }

            function close_popups() {
                document.getElementById('login_form').style.visibility='hidden';
                document.getElementById('login_form').style.pointerEvents='none';
                document.getElementById('signup_form').style.visibility='hidden';
                document.getElementById('signup_form').style.pointerEvents='none';
                document.getElementById('overlay_blur').style.visibility='hidden';
                document.getElementById('overlay_blur').style.pointerEvents='none';
            }

            document.addEventListener("DOMContentLoaded", function() {
                const url_params = new URLSearchParams(window.location.search);
                const status_value = url_params.get("s");
                console.log(status_value);
                if (!(status_value === null || status_value === "")) {
                    let status_message = "";
                    switch(status_value) {
                        case "0":
                            status_message = "Invalid password or username. Please try again";
                            break;
                        case "1":
                            status_message = "Username too long. Can't be longer than 20 characters";
                            break;
                        case "2":
                            status_message = "Username too short. Can't be shorter than 5 characters";
                            break;
                        case "3":
                            status_message = "Username contains invalid characters";
                            break;
                        case "4":
                            status_message = "Email is too long. Can't be longer than 254 characters";
                            break;
                        case "5":
                            status_message = "Invalid email formatting";
                            break;
                        case "6":
                            status_message = "Password too long. Can't be longer than 128 characters";
                            break;
                        case "7":
                            status_message = "Password too short. Can't be shorter than 8 characters";
                            break;
                        case "8":
                            status_message = "Username already exists. Please use another username";
                            break;
                    }
                    if(status_value == "0") {
                        show_login_popup(status_message);
                    } else {
                        show_signup_popup(status_message);
                    }
                    url_params.delete("s");
                    const url = new URL(window.location.href);
                    url.search = url_params.toString();
                    window.history.replaceState({}, "", url);
                }
            });
        </script>
    </head>
    <body>
        <aside>
            <div>
                <a class="icon" href="/">
                    <svg width="20" height="20" viewBox="0 0 250 250">
                            break;
                        <g fill="#ffffff"><path d="m235.648 194.212c-13.918-.347-24.705 1.045-33.752 4.872-2.61 1.043-6.786 1.044-7.134 4.35 1.392 1.392 1.566 3.654 2.784 5.567 2.09 3.479 5.741 8.177 9.047 10.614 3.653 2.783 7.308 5.566 11.134 8.002 6.786 4.176 14.442 6.611 21.053 10.787 3.829 2.434 7.654 5.568 11.482 8.177 1.914 1.39 3.131 3.654 5.568 4.523v-.521c-1.219-1.567-1.567-3.828-2.784-5.568-1.738-1.74-3.48-3.306-5.22-5.046-5.045-6.784-11.308-12.7-18.093-17.571-5.567-3.828-17.747-9.047-20.008-15.485 0 0-.175-.173-.348-.347 3.827-.348 8.35-1.74 12.005-2.784 5.915-1.567 11.308-1.218 17.398-2.784 2.783-.696 5.567-1.566 8.35-2.436v-1.565c-3.13-3.132-5.392-7.307-8.698-10.265-8.873-7.657-18.617-15.137-28.707-21.4-5.394-3.48-12.354-5.742-18.095-8.699-2.086-1.045-5.567-1.566-6.784-3.306-3.133-3.827-4.873-8.872-7.134-13.396-5.044-9.57-9.917-20.182-14.267-30.272-3.13-6.786-5.044-13.572-8.872-19.834-17.92-29.577-37.406-47.497-67.33-65.07-6.438-3.653-14.093-5.219-22.27-7.132-4.348-.175-8.699-.522-13.048-.697-2.784-1.218-5.568-4.523-8.004-6.089-9.915-6.264-35.492-19.833-42.799-1.913-4.698 11.308 6.96 22.442 10.96 28.185 2.96 4.001 6.786 8.524 8.874 13.048 1.218 2.956 1.565 6.09 2.783 9.221 2.785 7.653 5.393 16.18 9.048 23.314 1.914 3.653 4.001 7.48 6.437 10.786 1.392 1.913 3.827 2.784 4.35 5.915-2.435 3.48-2.61 8.7-4.003 13.049-6.263 19.66-3.826 44.017 5.046 58.457 2.783 4.348 9.395 13.92 18.268 10.265 7.83-3.131 6.09-13.048 8.35-21.747.524-2.09.176-3.48 1.219-4.872v.349c2.436 4.87 4.871 9.569 7.133 14.44 5.394 8.524 14.788 17.398 22.617 23.314 4.177 3.13 7.482 8.524 12.702 10.438v-.523h-.349c-1.044-1.566-2.61-2.261-4.001-3.48-3.131-3.13-6.612-6.958-9.047-10.438-7.306-9.744-13.745-20.53-19.486-31.665-2.783-5.392-5.22-11.308-7.481-16.701-1.045-2.09-1.045-5.22-2.784-6.263-2.61 3.827-6.437 7.133-8.351 11.83-3.304 7.481-3.653 16.702-4.871 26.27-.696.176-.349 0-.697.35-5.566-1.394-7.48-7.134-9.569-12.006-5.22-12.352-6.09-32.186-1.565-46.452 1.218-3.654 6.438-15.136 4.35-18.616-1.044-3.306-4.525-5.22-6.438-7.829-2.261-3.306-4.698-7.48-6.263-11.135-4.176-9.743-6.264-20.53-10.787-30.273-2.088-4.524-5.74-9.22-8.699-13.396-3.305-4.697-6.959-8.004-9.569-13.571-.869-1.913-2.088-5.045-.696-7.133.348-1.392 1.043-1.913 2.436-2.261 2.262-1.915 8.7.521 10.96 1.565 6.438 2.608 11.831 5.046 17.225 8.699 2.435 1.74 5.045 5.046 8.176 5.916h3.654c5.568 1.217 11.83.348 17.05 1.913 9.222 2.957 17.572 7.307 25.054 12.005 22.792 14.44 41.58 34.97 54.282 59.501 2.088 4 2.957 7.656 4.871 11.83 3.655 8.526 8.178 17.225 11.83 25.576 3.654 8.176 7.133 16.528 12.353 23.314 2.61 3.652 13.048 5.567 17.746 7.481 3.48 1.565 8.874 2.958 12.005 4.871 5.915 3.652 11.83 7.83 17.398 11.83 2.784 2.088 11.482 6.438 12.005 9.917z"/><path d="m58.186 43.022c-2.957 0-5.044.35-7.132.871v.348h.348c1.393 2.784 3.827 4.698 5.566 7.133 1.393 2.783 2.61 5.568 4.003 8.352.173-.175.347-.348.347-.348 2.437-1.741 3.654-4.524 3.654-8.7-1.044-1.217-1.218-2.435-2.088-3.653-1.043-1.741-3.306-2.61-4.698-4.003z"/></g>
                    </svg>
                </a>
                <a class="expand_icon" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M6.835 4c-.451.004-.82.012-1.137.038-.386.032-.659.085-.876.162l-.2.086c-.44.224-.807.564-1.063.982l-.103.184c-.126.247-.206.562-.248 1.076-.043.523-.043 1.19-.043 2.135v2.664c0 .944 0 1.612.043 2.135.042.515.122.829.248 1.076l.103.184c.256.418.624.758 1.063.982l.2.086c.217.077.49.13.876.162.316.026.685.034 1.136.038zm11.33 7.327c0 .922 0 1.654-.048 2.243-.043.522-.125.977-.305 1.395l-.082.177a4 4 0 0 1-1.473 1.593l-.276.155c-.465.237-.974.338-1.57.387-.59.048-1.322.048-2.244.048H7.833c-.922 0-1.654 0-2.243-.048-.522-.042-.977-.126-1.395-.305l-.176-.082a4 4 0 0 1-1.594-1.473l-.154-.275c-.238-.466-.34-.975-.388-1.572-.048-.589-.048-1.32-.048-2.243V8.663c0-.922 0-1.654.048-2.243.049-.597.15-1.106.388-1.571l.154-.276a4 4 0 0 1 1.594-1.472l.176-.083c.418-.18.873-.263 1.395-.305.589-.048 1.32-.048 2.243-.048h4.334c.922 0 1.654 0 2.243.048.597.049 1.106.15 1.571.388l.276.154a4 4 0 0 1 1.473 1.594l.082.176c.18.418.262.873.305 1.395.048.589.048 1.32.048 2.243zm-10 4.668h4.002c.944 0 1.612 0 2.135-.043.514-.042.829-.122 1.076-.248l.184-.103c.418-.256.758-.624.982-1.063l.086-.2c.077-.217.13-.49.162-.876.043-.523.043-1.19.043-2.135V8.663c0-.944 0-1.612-.043-2.135-.032-.386-.085-.659-.162-.876l-.086-.2a2.67 2.67 0 0 0-.982-1.063l-.184-.103c-.247-.126-.562-.206-1.076-.248-.523-.043-1.19-.043-2.135-.043H8.164L8.165 4z"/></svg>
                </a>
            </div>
            <div>
                <a class="menu_item" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.669 11.333V8.667c0-.922 0-1.655.048-2.244.048-.597.15-1.106.387-1.571l.155-.276a4 4 0 0 1 1.593-1.472l.177-.083c.418-.179.872-.263 1.395-.305.589-.048 1.32-.048 2.243-.048h.5a.665.665 0 0 1 0 1.33h-.5c-.944 0-1.613 0-2.135.043-.386.032-.66.085-.876.162l-.2.086a2.67 2.67 0 0 0-1.064.982l-.102.184c-.126.247-.206.562-.248 1.076-.043.523-.043 1.192-.043 2.136v2.666c0 .944 0 1.613.043 2.136.042.514.122.829.248 1.076l.102.184c.257.418.624.758 1.064.982l.2.086c.217.077.49.13.876.161.522.043 1.19.044 2.135.044h2.667c.944 0 1.612-.001 2.135-.044.514-.042.829-.121 1.076-.247l.184-.104c.418-.256.759-.623.983-1.062l.086-.2c.077-.217.13-.49.16-.876.043-.523.044-1.192.044-2.136v-.5a.665.665 0 0 1 1.33 0v.5c0 .922.001 1.655-.047 2.244-.043.522-.127.977-.306 1.395l-.083.176a4 4 0 0 1-1.471 1.593l-.276.154c-.466.238-.975.34-1.572.39-.59.047-1.321.047-2.243.047H8.667c-.923 0-1.654 0-2.243-.048-.523-.043-.977-.126-1.395-.305l-.177-.084a4 4 0 0 1-1.593-1.471l-.155-.276c-.237-.465-.339-.974-.387-1.57-.049-.59-.048-1.322-.048-2.245m10.796-8.22a2.43 2.43 0 0 1 3.255.167l.167.185c.727.892.727 2.18 0 3.071l-.168.185-5.046 5.048a4 4 0 0 1-1.945 1.072l-.317.058-1.817.26a.665.665 0 0 1-.752-.753l.26-1.816.058-.319a4 4 0 0 1 1.072-1.944L13.28 3.28zm2.314 1.108a1.103 1.103 0 0 0-1.476-.076l-.084.076-5.046 5.048a2.67 2.67 0 0 0-.716 1.296l-.04.212-.134.939.94-.134.211-.039a2.67 2.67 0 0 0 1.298-.716L15.78 5.78l.076-.084c.33-.404.33-.988 0-1.392z"/></svg>
                    <p>New chat</p>
                </a>
                <a class="menu_item" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M14.086 8.75a5.335 5.335 0 1 0-10.67 0 5.335 5.335 0 0 0 10.67 0m1.33 0a6.64 6.64 0 0 1-1.512 4.225l.066.055 3 3 .086.104a.666.666 0 0 1-.922.922l-.104-.085-3-3-.055-.068a6.665 6.665 0 1 1 2.44-5.153"/></svg>
                    <p>Search chats</p>
                </a>
                <a class="menu_item" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.388 8.534a1.25 1.25 0 1 1 .347 2.477 1.25 1.25 0 0 1-.347-2.477"/><path fill-rule="evenodd" d="M10.389 5.587c.459-.019.872.01 1.27.155l.23.095c.53.241.983.625 1.31 1.11l.084.133c.184.316.293.667.374 1.06.091.443.158.996.242 1.68l.346 2.812.11.93q.047.42.06.757c.017.402-.003.769-.105 1.12l-.05.15c-.2.549-.547 1.031-1.002 1.393l-.201.148c-.35.236-.745.365-1.195.458q-.33.067-.749.124l-.93.118-2.812.346c-.684.084-1.236.152-1.688.17-.401.017-.768-.004-1.12-.106l-.149-.049a3.17 3.17 0 0 1-1.394-1.003l-.147-.2c-.236-.351-.365-.745-.458-1.195q-.067-.33-.124-.75l-.118-.929-.346-2.812c-.084-.684-.152-1.237-.17-1.688-.02-.459.01-.872.154-1.27l.095-.23a3.17 3.17 0 0 1 1.11-1.31l.133-.084c.316-.185.667-.293 1.06-.374.443-.092.996-.159 1.68-.243L8.7 5.758l.93-.11q.42-.046.758-.061m-3.632 7.472a1.84 1.84 0 0 0-1.094.093c-.16.065-.334.183-.594.43-.265.255-.577.605-1.028 1.111l-.393.44q.034.214.07.391c.076.369.158.572.257.719l.086.117c.21.264.49.465.808.581l.136.04c.149.034.342.048.624.036.384-.015.874-.075 1.58-.162l2.812-.344.91-.117.247-.037-2.563-2.05c-.53-.424-.897-.716-1.201-.922a2.4 2.4 0 0 0-.525-.287zm3.686-6.143c-.192.008-.411.027-.67.055l-.91.107-2.812.345c-.706.086-1.196.147-1.573.225-.276.057-.46.118-.596.187l-.122.071c-.281.19-.504.453-.644.76l-.055.134c-.06.166-.091.383-.076.76.016.384.076.874.162 1.58l.276 2.25.221-.247q.273-.297.505-.521c.319-.305.634-.547 1.011-.701l.227-.083a3.17 3.17 0 0 1 1.659-.076l.147.037c.339.098.647.268.966.484.358.243.773.575 1.286.985l3.152 2.52c.182-.185.324-.407.414-.654l.04-.136c.033-.149.047-.342.036-.624a10 10 0 0 0-.055-.67l-.107-.91-.345-2.813c-.087-.705-.148-1.195-.226-1.572a2.4 2.4 0 0 0-.186-.597l-.071-.122a1.84 1.84 0 0 0-.76-.643l-.134-.055c-.167-.06-.383-.091-.76-.076" clip-rule="evenodd"/><path d="M9.728 1.59c.452.018 1.004.087 1.688.17l2.812.346.93.118q.419.058.75.124c.45.093.843.222 1.194.458l.2.148c.456.362.803.844 1.004 1.394l.048.149c.103.351.123.718.107 1.12q-.016.338-.062.757l-.11.93-.345 2.813c-.084.684-.15 1.236-.242 1.679-.081.394-.19.744-.374 1.06l-.084.134a3.2 3.2 0 0 1-.518.593l-.109.079a.666.666 0 0 1-.776-1.072l.16-.162q.076-.087.14-.182l.072-.122c.068-.136.13-.32.186-.597.078-.377.14-.866.226-1.572l.345-2.813.107-.91c.028-.258.047-.477.055-.67a2.4 2.4 0 0 0-.036-.624l-.04-.135a1.84 1.84 0 0 0-.582-.808l-.117-.086c-.147-.1-.35-.182-.718-.258a10 10 0 0 0-.663-.11l-.91-.115-2.812-.345c-.706-.087-1.196-.147-1.58-.162a2.4 2.4 0 0 0-.624.036l-.136.04a1.84 1.84 0 0 0-.809.581l-.085.117c-.067.1-.127.227-.182.412l-.051.125a.666.666 0 0 1-1.225-.503l.069-.207a2.6 2.6 0 0 1 .287-.57l.147-.202A3.17 3.17 0 0 1 8.46 1.745l.15-.049c.35-.102.718-.123 1.12-.106"/></svg>
                    <p>Images</p>
                </a>
            </div>
            {% if 'username' not in session %}
            <div id="login_reminder">
                <p class="bold">Get responses tailored to you</p>
                <p class="gray">Log in to get answers based on saved chats, plus create images and upload files.</p>
                <button id="bottom_login_button" onclick="show_login_popup()">
                    <p>Log in</p>
                </button>
            </div>
            {% endif %}
        </aside>
        <main>
            <div id="top_buttons" style="margin-top:10px">
                <button id="model_select">
                    <span id="ChatSQL">ChatSQL</span>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M12.134 5.944a.666.666 0 0 1 .922.922l-.085.105-4.5 4.5a.666.666 0 0 1-.942 0l-4.5-4.5-.085-.105a.666.666 0 0 1 .922-.922l.105.085L8 10.06l4.03-4.03z"/></svg>
                </button>
                <button id="top_help_button">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M16.585 10a6.585 6.585 0 1 0-13.17 0 6.585 6.585 0 0 0 13.17 0m1.33 0a7.915 7.915 0 1 1-15.83 0 7.915 7.915 0 0 1 15.83 0"/><path d="M9.817 11.596c-.459 0-.729-.313-.729-.756v-.076c0-.637.33-1.058.967-1.431.697-.416.908-.686.908-1.183 0-.53-.411-.897-1.005-.897-.53 0-.886.26-1.059.74-.135.346-.378.497-.708.497-.426 0-.691-.264-.691-.675 0-.232.054-.438.162-.643C8.008 6.46 8.872 6 10.033 6c1.535 0 2.566.843 2.566 2.101 0 .816-.394 1.372-1.156 1.82-.718.417-.88.649-.95 1.103-.082.362-.292.572-.676.572M9.828 14c-.486 0-.88-.373-.88-.848s.394-.848.88-.848c.492 0 .886.373.886.848S10.32 14 9.828 14"/></svg>
                </button>
                {% if 'username' not in session %}
                
                <button id="top_signup_button" onclick="show_signup_popup()">
                    <p>Sign up for free</p>
                </button>
                <button id="top_login_button" onclick="show_login_popup()">
                    <p>Log in</p>
                </button>
                {% else %}
                <button type="submit" form="logout_form" id="top_signup_button" onclick="">
                    <p>Log Out</p>
                </button>
                <form id="logout_form" action="/logout" method="post"></form></form>
                {% endif %}
            </div>
            <div id="overlay_blur" style="visibility: hidden; pointer-events: none;"></div>
            <form id="login_form" class="popup" action="/login" method="post" style="visibility: hidden; pointer-events: none;">
                <svg xmlns="http://www.w3.org/2000/svg" onclick="close_popups()" viewBox="0 0 20 20"><path d="M14.255 4.755a.7.7 0 0 1 .99.99L10.99 10l4.255 4.255.09.11a.7.7 0 0 1-.97.97l-.11-.09L10 10.99l-4.255 4.255a.7.7 0 0 1-.99-.99L9.01 10 4.755 5.745l-.09-.11a.7.7 0 0 1 .97-.97l.11.09L10 9.01z"/></svg>
                <h2>Log in</h2>
                <p>Due to recent abuse only logged in<br>accounts can use our service.</p>
                <input type="text" maxlength="20" placeholder="Username" name="username">
                <input type="password" maxlength="128" placeholder="Password" name="password">
                <p id="login_status"></p>
                <input class="submit_button" type="submit" value="Continue">
            </form>
            <form id="signup_form" class="popup" action="/signup" method="post" style="visibility: hidden; pointer-events: none;">
                <svg xmlns="http://www.w3.org/2000/svg" onclick="close_popups()" viewBox="0 0 20 20"><path d="M14.255 4.755a.7.7 0 0 1 .99.99L10.99 10l4.255 4.255.09.11a.7.7 0 0 1-.97.97l-.11-.09L10 10.99l-4.255 4.255a.7.7 0 0 1-.99-.99L9.01 10 4.755 5.745l-.09-.11a.7.7 0 0 1 .97-.97l.11.09L10 9.01z"/></svg>
                <h2>Sign up</h2>
                <p>Please fill in your credentials to<br>create a ChatSQL account.</p>
                <input type="text" maxlength="20" placeholder="Username" name="username">
                <input type="email" placeholder="Email" name="email">
                <input type="password" maxlength="128" placeholder="Password" name="password">
                <p id="signup_status"></p>
                <input class="submit_button" type="submit" value="Continue">
            </form>
            <div id="chat">

            </div>
        </main>
    </body>
</html>